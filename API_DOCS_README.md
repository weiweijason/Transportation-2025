# API 文檔介面使用說明

## 🚀 快速開始

我已經為您的 Spirit Bus 專案建立了一個完整的 API 文檔介面，讓您可以輕鬆查看和測試所有 API 端點。

## 📁 新增的檔案

```
app/
├── routes/
│   └── api_docs.py          # API文檔路由控制器
└── templates/
    └── api_docs/
        ├── index.html       # 主要API文檔頁面
        └── test.html        # API測試介面
test_api_docs.py             # 測試啟動腳本
```

## 🔗 訪問方式

### 直接訪問（開發者專用）
- **主要文檔**：`http://localhost:5000/api-docs`
- **測試介面**：`http://localhost:5000/api-docs/test`

> **注意**：此API文檔介面僅供開發人員使用，不會在一般使用者的導航欄中顯示。

## ✨ 功能特色

### 📚 主要文檔頁面 (`/api-docs`)
- **自動發現**：自動掃描所有路由並分類顯示
- **分組顯示**：按 Blueprint 組織 API 端點
- **詳細資訊**：顯示 HTTP 方法、URL、描述、認證需求
- **統計資訊**：總端點數、API 端點數、需要認證的端點數
- **搜尋功能**：即時搜尋 API 端點
- **篩選功能**：
  - 全部端點
  - 僅 API 端點
  - 需要認證的端點
- **美觀介面**：現代化響應式設計

### 🧪 測試介面 (`/api-docs/test`)
- **即時測試**：直接在瀏覽器中測試 API
- **支援所有 HTTP 方法**：GET、POST、PUT、DELETE、PATCH
- **自定義請求**：
  - 自定義 URL
  - 自定義請求標頭
  - 自定義請求主體（JSON 格式）
- **快速測試按鈕**：預設常用 API 端點
- **詳細響應**：
  - HTTP 狀態碼
  - 響應時間
  - 響應標頭
  - 響應內容（JSON 高亮顯示）
- **認證支援**：自動包含登入 cookies

## 🚀 啟動應用程式

### 方法 1：使用測試腳本
```bash
python test_api_docs.py
```

### 方法 2：使用現有啟動方式
```bash
python run_app.py
```

## 📊 API 分類說明

文檔會自動將端點分為以下類別：

### 🔷 主要藍圖 (main)
- 首頁和基本頁面

### 🔐 認證 (auth)
- 登入、註冊、登出相關
- **NEW!** 服務條款頁面 (`/auth/terms-of-service`)
- **NEW!** 隱私政策頁面 (`/auth/privacy-policy`)

### 🎮 遊戲功能 (bylin)
- 精靈、道館、背包等遊戲功能

### 🏆 成就系統 (achievement)
- 成就相關 API

### 👥 社群功能 (community)
- 好友系統、社交功能

### ⚔️ 好友對戰 (friend_fight)
- 對戰房間、戰鬥相關

### 👑 管理功能 (admin)
- 管理員相關功能

## 🎯 使用建議

1. **開發階段**：使用 API 文檔確認端點正確性
2. **測試階段**：使用測試介面驗證 API 功能
3. **除錯階段**：查看詳細的請求/響應資訊
4. **文檔化**：與團隊分享 API 規格

## 🔧 自定義設定

如果您想修改 API 文檔的外觀或功能：

- **樣式修改**：編輯 `app/templates/api_docs/index.html` 中的 CSS
- **功能擴展**：在 `app/routes/api_docs.py` 中添加新的路由
- **過濾邏輯**：修改 `get_endpoints()` 函數中的端點過濾邏輯

## 📝 注意事項

1. **認證需求**：某些 API 需要登入後才能訪問，測試前請確保已登入
2. **CORS 設定**：測試介面使用 `fetch` API，依賴瀏覽器的同源政策
3. **響應格式**：系統會自動檢測並美化 JSON 響應

## 🆘 常見問題

### Q: 服務條款和隱私政策頁面無法訪問？
A: 確保這些路由已添加到 `app.py` 的 `public_paths` 清單中，以允許未登入用戶訪問。可以使用 `test_legal_pages.py` 腳本進行測試驗證。

### Q: 如何測試新增的法律文件頁面？
A: 運行專用測試腳本：
```bash
python test_legal_pages.py
```
該腳本會自動測試服務條款和隱私政策頁面的可訪問性，以及註冊頁面的連結功能。

### Q: 為什麼某些 API 測試失敗？
A: 可能是因為：
- 需要先登入
- 需要特定的請求參數
- API 端點不存在或已變更

### Q: 如何添加新的快速測試按鈕？
A: 在 `app/templates/api_docs/test.html` 的快速測試區域添加新的按鈕並設定對應的 URL 和方法。

### Q: 文檔沒有顯示某個端點？
A: 檢查該端點是否正確註冊為 Flask 路由，以及是否有適當的裝飾器。

---

🎉 **恭喜！您現在有了一個完整的 API 文檔系統！**

這個介面將大大提升您的開發效率，讓 API 的使用和測試變得更加簡單。
